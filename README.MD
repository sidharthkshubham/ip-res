# IP Restriction System

A full-stack web application that validates user access based on their IP address. The system allows access only to users from Madhya Pradesh, India, and can also block specific IP addresses.

## ğŸŒŸ Overview

This application automatically detects a user's IP address and validates whether they should be granted access based on:
- Geographic location (Madhya Pradesh only)
- Blocked IP list maintained in the database

## ğŸ› ï¸ Tech Stack

### Frontend
- **React.js** - UI framework
- **Vite** - Build tool and development server
- **Tailwind CSS** - Styling framework
- **JavaScript (ES6+)** - Programming language

### Backend
- **Node.js** - Runtime environment
- **Express.js** - Web framework
- **Prisma ORM** - Database ORM
- **PostgreSQL** - Database
- **dotenv** - Environment variable management

### Deployment
- **VM Server** - Ubuntu 22.04 LTS (DigitalOcean)
- **Nginx** - Web server and reverse proxy
- **PM2** - Process manager for Node.js
- **Let's Encrypt (Certbot)** - SSL certificate

## ğŸ”Œ External APIs Used

### 1. ipify API (Frontend)
- **Purpose**: Detects user's public IP address
- **URL**: `https://api.ipify.org?format=json`
- **Cost**: Free, no API key required

### 2. ip-api.com (Backend)
- **Purpose**: Retrieves geolocation data (country, region, city)
- **URL**: `http://ip-api.com/json/{ip}`
- **Cost**: Free, rate limit: 45 requests/minute

## ğŸ—„ï¸ Database Schema

**AllowedIP Table:**
- Stores IP addresses from Madhya Pradesh with location details
- Fields: id, ip (unique), label, createdAt, updatedAt

**BlockedIP Table:**
- Stores blocked IP addresses with reason
- Fields: id, ip (unique), reason, createdAt, updatedAt

## ğŸ”„ System Flow

1. User visits the website â†’ Frontend loads
2. Frontend calls ipify API â†’ Gets user's IP address
3. Frontend sends IP to backend â†’ API validates the IP
4. Backend checks database â†’ Is IP already allowed/blocked?
5. Backend calls ip-api.com â†’ Gets geolocation data
6. Backend validates region â†’ Is user from Madhya Pradesh?
7. Backend stores/updates IP â†’ Saves to database
8. Backend responds â†’ Returns allowed/denied status
9. Frontend displays result â†’ Shows green (allowed) or red (denied) screen

## ğŸš€ API Endpoints

### Health Check
- **Endpoint**: `GET /api/health`
- **Purpose**: Check if API is running

### Validate IP
- **Endpoint**: `GET /api/v1/validate?ip={ipAddress}`
- **Purpose**: Validate user's IP address and location
- **Responses**:
  - Allowed: IP from Madhya Pradesh
  - Blocked: IP in blocked list
  - Restricted: IP from other regions

## ğŸŒ Deployment Details

### Frontend
- **Live URL**: https://ip-res.nextping.blog
- **Server**: Ubuntu 22.04 LTS (DigitalOcean)
- **Web Server**: Nginx with SSL/TLS (Let's Encrypt)
- **Location**: `/var/www/ip-res/ip-restrict/dist`

### Backend
- **API URL**: https://api.ip-res.nextping.blog
- **Server**: Same VM (internal port 3000)
- **Process Manager**: PM2 for automatic restarts
- **Database**: PostgreSQL
- **Environment**: Node.js v18+

## ğŸ”’ Security Features

- âœ… CORS Protection for API access control
- âœ… SSL/TLS encryption (HTTPS)
- âœ… IP address format validation
- âœ… Database unique constraints
- âœ… Environment variable protection
- âœ… Rate limiting via external API

## ğŸ“Š Key Features

- âœ… Automatic IP detection
- âœ… Geographic validation (Madhya Pradesh only)
- âœ… IP blocking system
- âœ… Real-time validation
- âœ… Responsive UI with loading states
- âœ… Error handling and fallbacks
- âœ… Database persistence
- âœ… Production-ready deployment

## ğŸ“ˆ Performance Metrics

- **Frontend Load Time**: < 2 seconds
- **API Response Time**: < 500ms
- **Database Query Time**: < 100ms
- **Geolocation API**: < 300ms

## ğŸ“ Environment Variables

### Backend (.env)
- `DATABASE_URL` - PostgreSQL connection string
- `PORT` - Server port (default: 3000)

## ğŸ‘¥ Project Information

- **Developer**: Shubham Kumar
- **Repository**: https://github.com/sidharthkshubham/ip-res
- **Live Demo**: https://ip-res.nextping.blog
- **API Endpoint**: https://api.ip-res.nextping.blog

## ğŸ“„ License

This project is proprietary and confidential.

---

**Last Updated**: December 3, 2025